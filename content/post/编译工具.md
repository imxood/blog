+++
date = "2019-04-17T19:00:00+08:00"
draft = true
title = "编译工具"
+++

### 测试代码 hello.c:
~~~c
#include <stdio.h>

int main(void)
{
    printf("hello, the world!\n");
    return 0;
}
~~~

## gcc
~~~
imxood@imxood-pc:~/develop$ gcc -c hello.c
# 得到hello.o
    -E, Preprocess only; do not compile, assemble or link
    -S, Compile only; do not assemble or link
    -c, Compile and assemble, but do not link
    -o, the output file
~~~

## readelf
~~~ shell
imxood@imxood-pc:~/develop$ readelf -h hello.o
ELF Header:
  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 
  Class:                             ELF64
  Data:                              2's complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              REL (Relocatable file)
  Machine:                           Advanced Micro Devices X86-64
  Version:                           0x1
  Entry point address:               0x0
  Start of program headers:          0 (bytes into file)
  Start of section headers:          680 (bytes into file)
  Flags:                             0x0
  Size of this header:               64 (bytes)
  Size of program headers:           0 (bytes)
  Number of program headers:         0
  Size of section headers:           64 (bytes)
  Number of section headers:         13
  Section header string table index: 10
~~~

## objcopy
~~~
arm-zephyr-eabi-objcopy -S -Obinary -j .dccm_data zephyr.elf dccm.bin
# 提取出zephyr.elf中的.dccm_data段, 输出到dccm.bin文件
  -S, "Remove all symbol and relocation information"
  -j <name>, "Only copy section <name> into the output"

arm-zephyr-eabi-objcopy -S -Obinary -R .comment -R COMMON -R .eh_frame -R .iccm_text -R .iccm_rodata -R .dccm_data zephyr.elf sram.bin
删除对应段，并把处理后的内容输出到sram.bin
  -R <name>, "Remove section <name> from the output"
~~~
